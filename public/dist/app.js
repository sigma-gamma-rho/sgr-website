angular.module("userApp",["authService","mainCtrl","ngAnimate","app.routes","authService","userService","adminCtrl","profileCtrl"]).config(["$httpProvider",function(e){e.interceptors.push("AuthInterceptor")}]),angular.module("authService",[]).factory("Auth",["$http","$q","$window",function(e,t,o){var r={};return r.login=function(t,o){return e.post("/api/authenticate",{username:t,password:o})},r.logout=function(){o.localStorage.removeItem("token")},r.isLoggedIn=function(){return!!o.localStorage.getItem("token")},r.getUser=function(){return e.get("/api/me")},r}]).factory("AuthInterceptor",["$q","$location","$window",function(e,t,o){var r={};return r.request=function(e){var t=o.localStorage.getItem("token");return t&&(e.headers["x-access-token"]=t),e},r.responseError=function(e){return 401==e.status&&(console.log("Interceptor caught 401, redirecting"),o.localStorage.removeItem("token")),403==e.status&&(console.log("Interceptor caught 403, redirecting"),o.localStorage.removeItem("token"),t.path("/login")),e},r}]),angular.module("userService",[]).factory("User",["$http",function(e){var t={};return t.get=function(t){return e.get("/api/users/"+t)},t.all=function(){return e.get("/api/users/")},t.create=function(t){return e.post("/api/users/",t)},t.update=function(t,o){return e.put("/api/users/"+t,o)},t["delete"]=function(t){return e["delete"]("/api/users/"+t)},t}]),angular.module("app.routes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"views/home.html"}).when("/login",{templateUrl:"views/login.html",controller:"mainController",controllerAs:"login"}).when("/admin",{templateUrl:"views/all.html",controller:"adminController",controllerAs:"admin"}).when("/users/create",{templateUrl:"views/profile.html",controller:"createController",controllerAs:"profile"}).when("/users/edit/:user_id",{templateUrl:"views/profile.html",controller:"editController",controllerAs:"profile"}).when("/users/view/:user_id",{templateUrl:"views/profile.html",controller:"viewController",controllerAs:"profile"}).otherwise({redirectTo:"/login"}),t.html5Mode(!0)}]),angular.module("adminCtrl",["userService"]).controller("adminController",["User","Auth",function(e,t){var o=this;o.init=function(){e.all().then(function(e){e.data.success&&(o.users=e.data.info),console.log(e.data.message)})},o.init(),o["delete"]=function(t){e["delete"](t).then(function(e){console.log(e.data.message),o.init()})}}]),angular.module("mainCtrl",[]).controller("mainController",["$rootScope","$location","$window","Auth",function(e,t,o,r){var n=this;n.loggedIn=r.isLoggedIn(),e.$on("$routeChangeStart",function(){n.loggedIn=r.isLoggedIn(),n.loggedIn&&o.localStorage.getItem("token")&&r.getUser().success(function(e){e.success&&(n.user=e.info,console.log(JSON.stringify(e.info)),console.log(e.message))}).error(function(e){console.log(e.message)})}),n.doLogin=function(){n.processing=!0,n.error="",r.login(n.loginData.username,n.loginData.password).success(function(e){e.success&&(n.processing=!1,o.localStorage.setItem("token",e.token),t.path("/"),console.log(e.message))}).error(function(e){e.success||(n.error=e.message,console.log(e.message))})},n.doLogout=function(){r.logout(),console.log("Token removed. You have successfully logged out."),n.user="",t.path("/login"),n.loggedIn=!1}}]),angular.module("profileCtrl",["userService"]).controller("createController",["User",function(e){var t=this;t.type="create",t.saveUser=function(){t.message="",e.create(t.userData).then(function(e){e.data.success&&(t.userData={}),t.message=e.data.message})}}]).controller("viewController",["$routeParams","User",function(e,t){var o=this;o.type="view",t.get(e.user_id).then(function(e){console.log(e),e.data.success&&(o.userData=e.data.info),console.log(e.data.message)})}]).controller("editController",["$routeParams","User",function(e,t){var o=this;o.type="edit",t.get(e.user_id).then(function(e){console.log(e),e.data.success&&(o.userData=e.data.info),console.log(e.data.message)}),o.saveUser=function(){o.message="",t.update(e.user_id,o.userData).then(function(e){e.data.success&&(o.userData={}),o.message=e.data.message})}}]);